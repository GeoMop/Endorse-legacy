#################
# Test goal: Test of boundary field interpolation
# Author: Jan Stebel
# Source for reference: qualitative

flow123d_version: 3.0.0_dev
problem: !Coupling_Sequential
  description: Interpolated boundary condition - small cube
  mesh:
    mesh_file: random_fractures_healed_2.msh # kvadr_old_2.msh
  flow_equation: !Flow_Darcy_MH
    output_specific:
    nonlinear_solver:
      linear_solver: !Petsc
        a_tol: 1.0e-07
    input_fields:
      - region: .sides
        bc_type: dirichlet
        bc_piezo_head: !FieldFE
          mesh_data_file: proudeni.msh
          field_name: piezo_head_p0
          interpolation: P0_intersection
      - region: box
        anisotropy: 1
        sigma: 0.5
        conductivity: 1.0e-8
      - region: fr
        anisotropy: 1
        sigma: 0.5
        conductivity: 1.0e-7
      - region: edz
        anisotropy: 1
        sigma: 0.5
        conductivity: 1.0e-07
    n_schurs: 2
    output:
      fields:
        - piezo_head_p0
        #- pressure_p0
        #- pressure_p1
        - velocity_p0
        - region_id
    balance: {}
    output_stream:
      file: ./small_cube.pvd
      format: !vtk
        variant: ascii
      name: flow_output_stream

  solute_equation: !Coupling_OperatorSplitting
    substances:
        - name: U235 # uranium 235
          molar_mass: 0.235
    transport: !Solute_Advection_FV
      input_fields:
        - region: box
          porosity: 0.01
          sources_density: 0 
        - region: edz
          porosity: 0.1
          sources_density: 0 
        - region: .borehole
          bc_type: total_flux
          bc_robin_sigma: 1
          bc_conc: !FieldFormula
            value: if((y > -1129275)&(y < -1129250), if((x > -682440)&(x < -682420), 20, 0),0)
          #bc_conc: 
          #    -  !FieldTimeFunction
          #      time_function: 
          #        values: !include_csv
          #          file: conc.csv
          #          separator: " "
          #          n_head_lines: 1
          #          format:
          #            t: $0
          #            value: $1
    output_stream:
      file: ./transport.pvd
      format: !vtk
        variant: ascii
      times:
        - step: 1e8
      name: transport_output_stream 
    time:
      end_time: 1e9
    balance:
      cumulative: true